import{d as $,s as A,j as W,k as F,u as G,i as Z,H as z,o as _,c as x,g as a,a as p,F as I,h as O,t as E,D as ee,f as o,n as S,A as te,e as L,l as D,O as se,y as ne,C as N,x as H,m as ae,P as ie,J as q,E as R}from"./app.5087e0a9.js";import{_ as re}from"./AlertIcon.dd096cc5.js";import{u as oe}from"./battleground.240561a1.js";import{p as le}from"./animation.bf1acf4d.js";const ce={class:"game-info-icon-box scale-125"},de={class:"flex flex-col"},he={class:"game-info-sidebar-close-box"},ue=a("h3",{class:"game-info-heading"},"Game Rules:",-1),ge={class:"mt-3"},me={class:"font-bold"},pe={class:"flex-between mt-10 gap-4 w-full"},fe=$({__name:"GameInfo",setup(n){const{avaxContract:e}=A(W()),{activeBattle:t}=A(F()),{setAlertInfo:s,setErrorMessage:i}=G(),r=["Card with the same defense and attack point will cancel each other out.","Attack points from the attacking card will deduct the opposing player's health points.","If P1 does not defend, their health wil be deducted by P2's attack.","If P1 defends, P2's attack is equal to P2's attack - P1's defense.","If a player defends, they refill 3 Mana","If a player attacks, they spend 3 Mana"],h=Z(),g=z(!1),u=async()=>{var d,b;if(!!confirm("You will lose this battle. Are your sure?"))try{const f=(d=t.value)==null?void 0:d.name;f&&(await((b=e.value)==null?void 0:b.quitBattle(f)),s({type:"info",message:`You're quitting the ${f} battle`}))}catch(f){i(f)}};return(c,d)=>{const b=re,f=te;return _(),x(I,null,[a("div",ce,[a("div",{class:"game-info-icon flex-center",onClick:d[0]||(d[0]=v=>g.value=!0)},[p(b,{type:"text-white"})])]),a("div",{class:S(["game-info-sidebar glass-effect flex-between backdrop-blur-3xl",o(g)?"translate-x-0":"translate-x-full"])},[a("div",de,[a("div",he,[a("div",{class:"flex-center game-info-sidebar-close",onClick:d[1]||(d[1]=v=>g.value=!1)}," x ")]),ue,a("div",ge,[(_(),x(I,null,O(r,(v,w)=>a("p",{key:w,class:"game-info-text"},[a("span",me,E(w+1)+".",1),ee(" "+E(v),1)])),64))])]),a("div",pe,[p(f,{title:"Change Battleground",onHandleClick:d[2]||(d[2]=v=>o(h).push("/battleground"))}),p(f,{title:"Exit Battle",onHandleClick:u})])],2)],64)}}}),ve=L(fe,[["__file","/home/runner/work/avax_gods/avax_gods/src/components/battle/GameInfo.vue"]]),ye=["src"],_e=$({__name:"ActionButton",props:{title:{type:String,required:!1},imgUrl:{type:String,required:!0},restStyles:{type:String,required:!0}},emits:["handleClick"],setup(n,{emit:e}){return(t,s)=>(_(),x("div",{class:S(["game-move-box flex-center glass-effect",n.restStyles]),onClick:s[0]||(s[0]=i=>e("handleClick"))},[a("img",{src:n.imgUrl,alt:"action_img",class:"game-move-icon"},null,8,ye)],2))}}),xe=L(_e,[["__file","/home/runner/work/avax_gods/avax_gods/src/components/battle/ActionButton.vue"]]);class y{constructor(e,t={}){if(!(e instanceof Node))throw"Can't initialize VanillaTilt because "+e+" is not a Node.";this.width=null,this.height=null,this.clientWidth=null,this.clientHeight=null,this.left=null,this.top=null,this.gammazero=null,this.betazero=null,this.lastgammazero=null,this.lastbetazero=null,this.transitionTimeout=null,this.updateCall=null,this.event=null,this.updateBind=this.update.bind(this),this.resetBind=this.reset.bind(this),this.element=e,this.settings=this.extendSettings(t),this.reverse=this.settings.reverse?-1:1,this.resetToStart=y.isSettingTrue(this.settings["reset-to-start"]),this.glare=y.isSettingTrue(this.settings.glare),this.glarePrerender=y.isSettingTrue(this.settings["glare-prerender"]),this.fullPageListening=y.isSettingTrue(this.settings["full-page-listening"]),this.gyroscope=y.isSettingTrue(this.settings.gyroscope),this.gyroscopeSamples=this.settings.gyroscopeSamples,this.elementListener=this.getElementListener(),this.glare&&this.prepareGlare(),this.fullPageListening&&this.updateClientSize(),this.addEventListeners(),this.reset(),this.resetToStart===!1&&(this.settings.startX=0,this.settings.startY=0)}static isSettingTrue(e){return e===""||e===!0||e===1}getElementListener(){if(this.fullPageListening)return window.document;if(typeof this.settings["mouse-event-element"]=="string"){const e=document.querySelector(this.settings["mouse-event-element"]);if(e)return e}return this.settings["mouse-event-element"]instanceof Node?this.settings["mouse-event-element"]:this.element}addEventListeners(){this.onMouseEnterBind=this.onMouseEnter.bind(this),this.onMouseMoveBind=this.onMouseMove.bind(this),this.onMouseLeaveBind=this.onMouseLeave.bind(this),this.onWindowResizeBind=this.onWindowResize.bind(this),this.onDeviceOrientationBind=this.onDeviceOrientation.bind(this),this.elementListener.addEventListener("mouseenter",this.onMouseEnterBind),this.elementListener.addEventListener("mouseleave",this.onMouseLeaveBind),this.elementListener.addEventListener("mousemove",this.onMouseMoveBind),(this.glare||this.fullPageListening)&&window.addEventListener("resize",this.onWindowResizeBind),this.gyroscope&&window.addEventListener("deviceorientation",this.onDeviceOrientationBind)}removeEventListeners(){this.elementListener.removeEventListener("mouseenter",this.onMouseEnterBind),this.elementListener.removeEventListener("mouseleave",this.onMouseLeaveBind),this.elementListener.removeEventListener("mousemove",this.onMouseMoveBind),this.gyroscope&&window.removeEventListener("deviceorientation",this.onDeviceOrientationBind),(this.glare||this.fullPageListening)&&window.removeEventListener("resize",this.onWindowResizeBind)}destroy(){clearTimeout(this.transitionTimeout),this.updateCall!==null&&cancelAnimationFrame(this.updateCall),this.reset(),this.removeEventListeners(),this.element.vanillaTilt=null,delete this.element.vanillaTilt,this.element=null}onDeviceOrientation(e){if(e.gamma===null||e.beta===null)return;this.updateElementPosition(),this.gyroscopeSamples>0&&(this.lastgammazero=this.gammazero,this.lastbetazero=this.betazero,this.gammazero===null?(this.gammazero=e.gamma,this.betazero=e.beta):(this.gammazero=(e.gamma+this.lastgammazero)/2,this.betazero=(e.beta+this.lastbetazero)/2),this.gyroscopeSamples-=1);const t=this.settings.gyroscopeMaxAngleX-this.settings.gyroscopeMinAngleX,s=this.settings.gyroscopeMaxAngleY-this.settings.gyroscopeMinAngleY,i=t/this.width,r=s/this.height,h=e.gamma-(this.settings.gyroscopeMinAngleX+this.gammazero),g=e.beta-(this.settings.gyroscopeMinAngleY+this.betazero),u=h/i,c=g/r;this.updateCall!==null&&cancelAnimationFrame(this.updateCall),this.event={clientX:u+this.left,clientY:c+this.top},this.updateCall=requestAnimationFrame(this.updateBind)}onMouseEnter(){this.updateElementPosition(),this.element.style.willChange="transform",this.setTransition()}onMouseMove(e){this.updateCall!==null&&cancelAnimationFrame(this.updateCall),this.event=e,this.updateCall=requestAnimationFrame(this.updateBind)}onMouseLeave(){this.setTransition(),this.settings.reset&&requestAnimationFrame(this.resetBind)}reset(){this.onMouseEnter(),this.fullPageListening?this.event={clientX:(this.settings.startX+this.settings.max)/(2*this.settings.max)*this.clientWidth,clientY:(this.settings.startY+this.settings.max)/(2*this.settings.max)*this.clientHeight}:this.event={clientX:this.left+(this.settings.startX+this.settings.max)/(2*this.settings.max)*this.width,clientY:this.top+(this.settings.startY+this.settings.max)/(2*this.settings.max)*this.height};let e=this.settings.scale;this.settings.scale=1,this.update(),this.settings.scale=e,this.resetGlare()}resetGlare(){this.glare&&(this.glareElement.style.transform="rotate(180deg) translate(-50%, -50%)",this.glareElement.style.opacity="0")}getValues(){let e,t;this.fullPageListening?(e=this.event.clientX/this.clientWidth,t=this.event.clientY/this.clientHeight):(e=(this.event.clientX-this.left)/this.width,t=(this.event.clientY-this.top)/this.height),e=Math.min(Math.max(e,0),1),t=Math.min(Math.max(t,0),1);let s=(this.reverse*(this.settings.max-e*this.settings.max*2)).toFixed(2),i=(this.reverse*(t*this.settings.max*2-this.settings.max)).toFixed(2),r=Math.atan2(this.event.clientX-(this.left+this.width/2),-(this.event.clientY-(this.top+this.height/2)))*(180/Math.PI);return{tiltX:s,tiltY:i,percentageX:e*100,percentageY:t*100,angle:r}}updateElementPosition(){let e=this.element.getBoundingClientRect();this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this.left=e.left,this.top=e.top}update(){let e=this.getValues();this.element.style.transform="perspective("+this.settings.perspective+"px) rotateX("+(this.settings.axis==="x"?0:e.tiltY)+"deg) rotateY("+(this.settings.axis==="y"?0:e.tiltX)+"deg) scale3d("+this.settings.scale+", "+this.settings.scale+", "+this.settings.scale+")",this.glare&&(this.glareElement.style.transform=`rotate(${e.angle}deg) translate(-50%, -50%)`,this.glareElement.style.opacity=`${e.percentageY*this.settings["max-glare"]/100}`),this.element.dispatchEvent(new CustomEvent("tiltChange",{detail:e})),this.updateCall=null}prepareGlare(){if(!this.glarePrerender){const e=document.createElement("div");e.classList.add("js-tilt-glare");const t=document.createElement("div");t.classList.add("js-tilt-glare-inner"),e.appendChild(t),this.element.appendChild(e)}this.glareElementWrapper=this.element.querySelector(".js-tilt-glare"),this.glareElement=this.element.querySelector(".js-tilt-glare-inner"),!this.glarePrerender&&(Object.assign(this.glareElementWrapper.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden","pointer-events":"none","border-radius":"inherit"}),Object.assign(this.glareElement.style,{position:"absolute",top:"50%",left:"50%","pointer-events":"none","background-image":"linear-gradient(0deg, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%)",transform:"rotate(180deg) translate(-50%, -50%)","transform-origin":"0% 0%",opacity:"0"}),this.updateGlareSize())}updateGlareSize(){if(this.glare){const e=(this.element.offsetWidth>this.element.offsetHeight?this.element.offsetWidth:this.element.offsetHeight)*2;Object.assign(this.glareElement.style,{width:`${e}px`,height:`${e}px`})}}updateClientSize(){this.clientWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.clientHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}onWindowResize(){this.updateGlareSize(),this.updateClientSize()}setTransition(){clearTimeout(this.transitionTimeout),this.element.style.transition=this.settings.speed+"ms "+this.settings.easing,this.glare&&(this.glareElement.style.transition=`opacity ${this.settings.speed}ms ${this.settings.easing}`),this.transitionTimeout=setTimeout(()=>{this.element.style.transition="",this.glare&&(this.glareElement.style.transition="")},this.settings.speed)}extendSettings(e){let t={reverse:!1,max:15,startX:0,startY:0,perspective:1e3,easing:"cubic-bezier(.03,.98,.52,.99)",scale:1,speed:300,transition:!0,axis:null,glare:!1,"max-glare":1,"glare-prerender":!1,"full-page-listening":!1,"mouse-event-element":null,reset:!0,"reset-to-start":!0,gyroscope:!0,gyroscopeMinAngleX:-45,gyroscopeMaxAngleX:45,gyroscopeMinAngleY:-45,gyroscopeMaxAngleY:45,gyroscopeSamples:10},s={};for(var i in t)if(i in e)s[i]=e[i];else if(this.element.hasAttribute("data-tilt-"+i)){let r=this.element.getAttribute("data-tilt-"+i);try{s[i]=JSON.parse(r)}catch{s[i]=r}}else s[i]=t[i];return s}static init(e,t){e instanceof Node&&(e=[e]),e instanceof NodeList&&(e=[].slice.call(e)),e instanceof Array&&e.forEach(s=>{"vanillaTilt"in s||(s.vanillaTilt=new y(s,t))})}}typeof document<"u"&&(window.VanillaTilt=y,y.init(document.querySelectorAll("[data-tilt]")));const be=$({__name:"Tilt",props:{parallax:{type:Boolean,required:!1},scaleSize:{type:null,required:!1}},setup(n){const e=n,t=z();return D(()=>y.init(t.value,{...e,scale:e.scaleSize||1})),(s,i)=>(_(),x("div",{ref_key:"wrapperRef",ref:t,class:S(n.parallax?"preserve":"")},[se(s.$slots,"default",{},void 0,!0)],2))}});const we=L(be,[["__scopeId","data-v-9297f3e0"],["__file","/home/runner/work/avax_gods/avax_gods/src/components/common/Tilt.vue"]]),ke=["src"],Se={class:"card-point-container flex-center sm:left-[21.2%] left-[22%] popout"},Me={class:"card-point text-yellow-400"},Ce={class:"card-point-container flex-center sm:right-[14.2%] right-[15%] popout"},Ee={class:"card-point text-red-700"},$e={class:"card-text-container flex-center popout"},Le={class:"card-text"},Be=$({__name:"Card",props:{card:{type:Object,required:!0},title:{type:String,required:!0},restStyles:{type:String,required:!1},isPlayerTwo:{type:Boolean,required:!1}},emits:["update:cardRef"],setup(n,{emit:e}){const t=["resources/cards/Ace.png","resources/cards/Bakezori.png","resources/cards/Black_Solus.png","resources/cards/Calligrapher.png","resources/cards/Chakri_Avatar.png","resources/cards/Coalfist.png","resources/cards/Desolator.png","resources/cards/Dusk_Rigger.png","resources/cards/Flamewreath.png","resources/cards/Furiosa.png","resources/cards/Geomancer.png","resources/cards/Gore_Horn.png","resources/cards/Heartseeker.png","resources/cards/Jade_Monk.png","resources/cards/Kaido_Expert.png","resources/cards/Katara.png","resources/cards/Ki_Beholder.png","resources/cards/Kindling.png","resources/cards/Lantern_Fox.png","resources/cards/Mizuchi.png","resources/cards/Orizuru.png","resources/cards/Scarlet_Viper.png","resources/cards/Storm_Kage.png","resources/cards/Suzumebachi.png","resources/cards/Tusk_Boar.png","resources/cards/Twilight_Fox.png","resources/cards/Void_Talon.png","resources/cards/Whiplash.png","resources/cards/Widowmaker.png","resources/cards/Xho.png"],s=()=>"/avax_gods/"+t[Math.floor(Math.random()*(t.length-1))],i=s(),r=s(),h=z();return D(()=>e("update:cardRef",h.value)),(g,u)=>{const c=we;return _(),x("div",{ref_key:"playerRef",ref:h,class:S(["card-container",n.restStyles])},[p(c,{parallax:"",max:60},{default:ne(()=>[a("img",{src:n.isPlayerTwo?o(i):o(r),alt:"card",class:"card-img"},null,8,ke),N(" Attack "),a("div",Se,[a("p",Me,E(n.card.attack>0?n.card.attack:"X"),1)]),N(" Defense "),a("div",Ce,[a("p",Ee,E(n.card.defense>0?n.card.defense:"X"),1)]),a("div",$e,[a("p",Le,E(n.title),1)])]),_:1})],2)}}});const Ae=L(Be,[["__scopeId","data-v-caedcf74"],["__file","/home/runner/work/avax_gods/avax_gods/src/components/common/Card.vue"]]),ze=["src","data-for"],Te=["data-for","data-tip"],Pe=["data-for"],Ye=25,Ie=$({__name:"PlayerInfo",props:{marginTop:{type:Boolean,required:!1},playerIcon:{type:String,required:!0},player:{type:null,required:!1}},setup(n){const e=n,t=H(()=>{var r;return[...Array((r=e.player)==null?void 0:r.health).keys()]}),s=H(()=>{var h;const r=((h=e.player)==null?void 0:h.health)||0;return r>=12?"bg-green-500":r>=6?"bg-orange-500":"bg-red-500"}),i=r=>r!==Ye-1?"mr-1":"mr-0";return(r,h)=>{var g,u;return _(),x("div",{class:S(["flex-center",n.marginTop?"mt-4":"mb-4"])},[a("img",{src:n.playerIcon,alt:"player_icon",class:"w-14 h-14 object-contain rounded-full","data-for":`Player-${n.marginTop?"1":"2"}`,"data-tip":""},null,8,ze),a("div",{class:"player-health","data-for":`Health-${n.marginTop?"1":"2"}`,"data-tip":`Health: ${(g=n.player)==null?void 0:g.health}`},[(_(!0),x(I,null,O(o(t),(c,d)=>(_(),x("div",{key:`player-item-${c}`,class:S(["player-health-bar",`${o(s)} ${i(d)}`])},null,2))),128))],8,Te),a("div",{class:"flex-center glass-effect player-mana","data-for":`Mana-${n.marginTop?"1":"2"}`,"data-tip":"Mana"},E(((u=n.player)==null?void 0:u.mana)||0),9,Pe),N(" TODO: player tooltips ")],2)}}}),Ne=L(Ie,[["__file","/home/runner/work/avax_gods/avax_gods/src/components/battle/PlayerInfo.vue"]]),Xe={class:"flex-center flex-col my-10"},He={class:"flex items-center flex-row"},j=$({__name:"[battleName]",props:{battleName:{type:String,required:!0}},setup(n){const e=n,t="/avax_gods/",s=`${t}resources/sounds/attack.wav`,i=`${t}resources/sounds/defense.mp3`,{setAlertInfo:r,setErrorMessage:h}=G(),{currentAccountAddress:g,avaxContract:u}=A(W()),{activeBattle:c,player1Ref:d,player2Ref:b}=A(F()),{battleground:f}=A(oe()),v=z({attack:-1,health:20,defense:10,mana:5,instance:{playerName:"Player1"}}),w=z({attack:10,health:25,defense:10,mana:5,instance:{playerName:"Player2"}}),K=async()=>{if(!(!c.value||c.value.players.some(l=>l.toLowerCase()==="0x0000000000000000000000000000000000000000".toLowerCase())||!u.value))try{let l,m;c.value.players[0].toLowerCase()===g.value.toLowerCase()?(l=c.value.players[0],m=c.value.players[1]):(l=c.value.players[1],m=c.value.players[0]);const k=await u.value.getPlayerToken(l),M=await u.value.getPlayer(l),C=await u.value.getPlayer(m),Y=k.attackStrength.toNumber(),T=k.defenseStrength.toNumber(),P=M.playerHealth.toNumber(),B=M.playerMana.toNumber(),J=C.playerHealth.toNumber(),Q=C.playerMana.toNumber();v.value={instance:M,attack:Y,defense:T,health:P,mana:B},w.value={instance:C,attack:-1,defense:-1,health:J,mana:Q}}catch(l){console.error(l),h(l)}},X=async l=>{var m;le(l===1?s:i);try{await((m=u.value)==null?void 0:m.attackOrDefendChoice(l,e.battleName,{gasLimit:2e5})),r({type:"info",message:`Initiating ${l===1?"attack":"defense"}`})}catch(k){h(k)}},U=()=>{const l=v.value.mana;if(l<3){r({type:"failure",message:["You need at least 3 mana to attack.",`You have ${l} mana.`,"Make a defense move to restore your mana"],timeout:5e3});return}X(1)},V=()=>X(2);return ae([u,c,e],K,{immediate:!0}),ie({title:`Fighting ${e.battleName}`}),(l,m)=>{var T,P;const k=Ne,M=Ae,C=xe,Y=ve;return _(),x("div",{class:S(["flex-between game-container bg-cover",o(f).id])},[p(k,{player:o(w),"player-icon":`${o(t)}resources/player02.png`,"margin-top":""},null,8,["player","player-icon"]),a("div",Xe,[p(M,{"card-ref":o(b),"onUpdate:card-ref":m[0]||(m[0]=B=>q(b)?b.value=B:null),card:o(w),title:(T=o(w))==null?void 0:T.instance.playerName,"is-player-two":""},null,8,["card-ref","card","title"]),a("div",He,[p(C,{"img-url":`${o(t)}resources/attack.png`,"rest-styles":"mr-2 hover:border-yellow-400",onHandleClick:U},null,8,["img-url"]),p(M,{"card-ref":o(d),"onUpdate:card-ref":m[1]||(m[1]=B=>q(d)?d.value=B:null),card:o(v),title:(P=o(v))==null?void 0:P.instance.playerName,"rest-styles":"mt-3"},null,8,["card-ref","card","title"]),p(C,{"img-url":`${o(t)}resources/defense.png`,"rest-styles":"ml-6 hover:border-red-600",onHandleClick:V},null,8,["img-url"])])]),p(k,{player:o(v),"player-icon":`${o(t)}resources/player01.png`},null,8,["player","player-icon"]),p(Y)],2)}}});typeof R=="function"&&R(j);const Ge=L(j,[["__file","/home/runner/work/avax_gods/avax_gods/src/pages/battle/[battleName].vue"]]);export{Ge as default};
